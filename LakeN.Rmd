---
title: "LakeN"
author: "Yoav Ben Dor"
date: "6.12.2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## Lake N model
# Yoav Ben Dor

This model was written as a project for course 68806 Eco-hydrologic modelling with R
This model illustrates the annual N cycle in a lake in northern Israel, and simulates the transitions from oxydized species into reduced species

# read the data and load relevant libraries
```{r Code Block 1, eval=TRUE, echo=FALSE}
# setwd("C:/Users/user/Documents/LakeN")
# load relevant libraries
library(plyr)
library(LakeN)
library(zoo)
library(devtools)
library(roxygen2)
library(dplyr)

# read the data for the model
# use the read.table function in the cas of a tab=delimited text file
# use the read.csv function for a , delimited text file
data1=read.table("LakeNData1.txt", header=TRUE)
data2=read.table("LakeNData2.txt", header=TRUE)
data3=read.table("LakeNData3.txt", header=TRUE)
data4=read.table("LakeNData4.txt", header=TRUE)

#split the data set by measurment date
data1.split=split(data1, f=data1$Date)

```
```{r Code Block 2, eval=TRUE, echo=FALSE}
# setwd("C:/Users/user/Documents/LakeN")
# load relevant libraries
summary(data1)

```

# use the function depthinterp to interpolate the data into uniform length for every m
```{r Code Block 3, eval=TRUE, echo=FALSE}
library(LakeN)

for (ii in 1:length(data1.split)){
  data1.split.interp[[ii]]=depthinterp(input=data1.split[[ii]])
  data1interp=data1.split.interp[[ii]]
}
```

# demonstrate some interpolations of random data
```{r Code Block 4, eval=TRUE, echo=FALSE}
rand.num=sample(1:length(data1.split),1)
plot(data1.split[[rand.num]]$Oxygen,data1.split[[rand.num]]$Depth,  
     main="Oxygen interpolation",ylab="Depth [m]", xlab="Oxygen [mol/l]",
     ylim=rev(range(data1.split.interp[[rand.num]]$Depth)), xlim=c(0, max(data1.split[[rand.num]]$Oxygen)))
lines(data1.split.interp[[rand.num]]$Oxygen,data1.split.interp[[rand.num]]$Depth,  col=2)

legend(0, 1, c("Measured", "Interpolation"), col = c(1, 2),
       lty = c(NA,1), pch = c(1, NA),
       merge = TRUE, bg = "gray90")

plot(data1.split[[rand.num]]$Nitrate,data1.split[[rand.num]]$Depth,  
     main="N species interpolation",ylab="Depth [m]", xlab="Nitrate/NH4 [mol/l]",
     ylim=rev(range(data1.split.interp[[rand.num]]$Depth)), xlim=c(0,max(c(max(data1.split[[rand.num]]$Nitrate),max(data1.split[[rand.num]]$NH4)))), col=1)
lines(data1.split.interp[[rand.num]]$Nitrate,data1.split.interp[[rand.num]]$Depth,  col=2)
points(data1.split[[rand.num]]$NH4,data1.split[[rand.num]]$Depth, col=3)
lines(data1.split.interp[[rand.num]]$NH4,data1.split.interp[[rand.num]]$Depth,  col=4)

legend(0.7*max(c(max(data1.split[[rand.num]]$Nitrate),max(data1.split[[rand.num]]$NH4))), 1, c("Measured NO2", "Interpolation","Measured NH4", "Interpolation"), col = c(1, 2,3,4),
       lty = c(NA,1,NA,1), pch = c(1,NA,1,NA),
       merge = TRUE, bg = "gray90")

```

